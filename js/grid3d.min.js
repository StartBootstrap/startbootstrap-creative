!function(e){"use strict";function t(e,t){this.el=e,this.options=extend({},this.options),extend(this.options,t),this._init()}t.prototype.options={},t.prototype._init=function(){this.gridWrap=this.el.querySelector("div.grid-wrap"),this.grid=this.gridWrap.querySelector("div.image-grid"),this.gridItems=[].slice.call(this.grid.children),this.itemSize={width:this.gridItems[0].offsetWidth,height:this.gridItems[0].offsetHeight},this.contentEl=this.el.querySelector("div.content"),this.contentItems=[].slice.call(this.contentEl.children),this.close=this.contentEl.querySelector("span.close-content"),this.loader=this.contentEl.querySelector("span.loading"),this.support=support.pointerevents&&support.csstransitions&&support.csstransforms3d,this._initEvents()},t.prototype._initEvents=function(){var t=this;this.gridItems.forEach(function(e,i){e.addEventListener("click",function(){t._showContent(i)})}),this.close.addEventListener("click",function(){t._hideContent()}),this.support&&(e.addEventListener("resize",function(){t._resizeHandler()}),e.addEventListener("scroll",function(){t.isAnimating?e.scrollTo(t.scrollPosition?t.scrollPosition.x:0,t.scrollPosition?t.scrollPosition.y:0):(t.scrollPosition={x:e.pageXOffset||docElem.scrollLeft,y:e.pageYOffset||docElem.scrollTop},t._scrollHandler())}))},t.prototype._showContent=function(e){if(this.isAnimating)return!1;this.isAnimating=!0;var t=this,i=function(){setTimeout(function(){classie.removeClass(t.loader,"show"),classie.addClass(t.contentItems[e],"show")},1e3),classie.addClass(t.contentEl,"show"),classie.addClass(t.loader,"show"),classie.addClass(document.body,"noscroll"),t.isAnimating=!1};if(!this.support)return i(),!1;var s=this.gridItems[e],o=s.innerHTML;this.placeholder=this._createPlaceholder(o),this.placeholder.style.left=s.offsetLeft+"px",this.placeholder.style.top=s.offsetTop+"px",this.grid.appendChild(this.placeholder);setTimeout(function(){classie.addClass(s,"active"),classie.addClass(t.gridWrap,"view-full"),t._resizePlaceholder();var e=function(t){if(-1===t.propertyName.indexOf("transform"))return!1;this.removeEventListener(transEndEventName,e),i()};t.placeholder.addEventListener(transEndEventName,e)},25)},t.prototype._hideContent=function(){var e=this,t=this.el.querySelector("div.content > .show"),i=this.gridItems[this.contentItems.indexOf(t)];if(classie.removeClass(t,"show"),classie.removeClass(this.contentEl,"show"),setTimeout(function(){classie.removeClass(document.body,"noscroll")},25),!this.support)return!1;classie.removeClass(this.gridWrap,"view-full"),this.placeholder.style.left=i.offsetLeft+"px",this.placeholder.style.top=i.offsetTop+"px",this.placeholder.style.width=this.itemSize.width+"px",this.placeholder.style.height=this.itemSize.height+"px";var s=function(t){this.removeEventListener(transEndEventName,s),e.placeholder.parentNode.removeChild(e.placeholder),classie.removeClass(i,"active")};this.placeholder.addEventListener(transEndEventName,s)},t.prototype._createPlaceholder=function(e){var t=document.createElement("div");t.className="front",t.innerHTML=e;var i=document.createElement("div");i.className="back",i.innerHTML="&nbsp;";var s=document.createElement("div");return s.className="placeholder",s.appendChild(t),s.appendChild(i),s},t.prototype._scrollHandler=function(){var e=this;this.didScroll||(this.didScroll=!0,setTimeout(function(){e._scrollPage()},60))},t.prototype._scrollPage=function(){var e=scrollY()+getViewportH()/2;this.gridWrap.style.WebkitPerspectiveOrigin="50% "+e+"px",this.gridWrap.style.MozPerspectiveOrigin="50% "+e+"px",this.gridWrap.style.perspectiveOrigin="50% "+e+"px",this.didScroll=!1},t.prototype._resizeHandler=function(){var e=this;this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(function(){e._resizePlaceholder(),e._scrollPage(),e._resizeTimeout=null},50)},t.prototype._resizePlaceholder=function(){if(this.itemSize={width:this.gridItems[0].offsetWidth,height:this.gridItems[0].offsetHeight},this.placeholder){var e=getOffset(this.grid);this.placeholder.style.left=Number(-1*(e.left-scrollX()))+"px",this.placeholder.style.top=Number(-1*(e.top-scrollY()))+"px",this.placeholder.style.width=getViewportW()+"px",this.placeholder.style.height=getViewportH()+"px"}},e.grid3D=t}(window);